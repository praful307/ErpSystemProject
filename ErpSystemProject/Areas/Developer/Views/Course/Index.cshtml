
    @{
        ViewData["Title"] = "Index";
        Layout = "~/Views/Shared/DeveloperLayout.cshtml";
    }
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<div class="container-fluid d-flex flex-column vh-100 p-2" style="background-color:#f7f9fc;">

    <!-- Form Card -->
    <div class="row flex-shrink-0 mb-2">
        <div class="col-md-10 mx-auto">
            <div class="card shadow-lg border-0 rounded-4">
                <div class="card-header text-center bg-gradient text-white rounded-top-4" style="background-color:navy">
                    <h3 class="fw-semibold mb-0"><i class="bi bi-journal-text me-2"></i>Add Training Course</h3>
                </div>
                <div class="card-body px-4 py-3">
                    <div class="row g-3">
                        <div class="col-md-6">
                            @Html.Hidden("txtid")
                            <label class="form-label fw-bold text-primary mb-1">Course Name</label>
                            @Html.TextBox("txtname", null, new { @class = "form-control shadow-sm", placeholder = "Enter Course Name" })
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold text-primary mb-1">Course Code</label>
                            @Html.TextBox("txtcode", null, new { @class = "form-control shadow-sm", placeholder = "Enter Course Code" })
                        </div>
                        <div class="col-md-12">
                            <label class="form-label fw-bold text-primary mb-1">Description</label>
                            @Html.TextArea("txtdes", null, new { @class = "form-control shadow-sm", placeholder = "Enter Course Description", rows = 2 })
                        </div>
                    </div>
                </div>
                <div class="card-footer text-center bg-light">
                    <button type="button" class="btn btn-success px-5 py-2 rounded-pill shadow-sm fw-semibold" id="btnsubmit" onclick="AddCourse()">
                        <i class="bi bi-check2-circle me-2"></i>Submit
                    </button>
                    <button type="button" class="btn btn-info px-5 py-2 rounded-pill shadow-sm fw-semibold" id="btnupdate" onclick="UdpateCustomer()">
                        <i class="bi bi-arrow-repeat me-2"></i>Update
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Search Bar -->
    <div class="row flex-shrink-0 mb-1">
        <div class="col-md-6 mx-auto">
            <div class="input-group shadow-sm rounded-pill">
                <span class="input-group-text  text-white rounded-start-pill" style="background-color:navy">
                    <i class="bi bi-search"></i>
                </span>
                <input type="text" class="form-control rounded-end-pill" id="txtserch" placeholder="Search courses here...">
            </div>
        </div>
    </div>


    <div class="row ">
        <div class="col-md-11 ">
            <div class="card shadow-sm border-0 rounded-4 ">
                <div class="card-body p-0   ">
                    <div class="table-responsive flex-grow-1">
                        <table class="table table-bordered table-striped mb-0 text-center align-middle w-100">
                            <thead class="table-primary sticky-top">
                                <tr>
                                    <th>Sr.No</th>
                                    <th>Course</th>
                                    <th>Course Code</th>
                                    <th>Description</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="tbldata"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>




<script>
    // Search Filter
    $("#txtserch").keyup(function () {
        var typeValue = $(this).val().toLowerCase();
        $("#tbldata tr").filter(function () {
            $(this).toggle($(this).text().toLowerCase().indexOf(typeValue) > -1);
        });
    });

    const AddCourse = async () => {
        var st = {
            "CourseName": document.getElementById("txtname").value,
            "CourseCode": document.getElementById("txtcode").value,
            "Description": document.getElementById("txtdes").value
        };
        const url = '@Url.Action("AddCourse", "Course", new { area = "Developer" })';
        const response = await fetch(url, {
            method:'post',
            body: JSON.stringify(st),
            headers: { 'content-type': 'application/json' }
        });
        await response.json();
        alert("Course Added Successfully");
        Display();
        clear();
    };

    const Display = async () => {
        const response = await fetch("/Developer/Course/GetCourses");
        const co = await response.json();

        var data = "";
        co.forEach(function(d,k){
            data += `<tr>
                        <td>${k+1}</td>
                        <td>${d.courseName}</td>
                        <td>${d.courseCode}</td>
                        <td>${d.description}</td>
                        <td>
                            <input type='button' value='View' class='btn btn-info me-1' onclick='EditData(${d.courseId})'/>
                            <input type='button' value='Delete' class='btn btn-danger' onclick='DeleteData(${d.courseId})'/>
                        </td>
                    </tr>`;
        });
        document.getElementById("tbldata").innerHTML = data;
    };

    const EditData = async (id) => {
        const response = await fetch("/Developer/Course/GetCourseById/"+id);
        const cous = await response.json();
        document.getElementById("txtid").value = cous.courseId;
        document.getElementById("txtname").value = cous.courseName;
        document.getElementById("txtcode").value = cous.courseCode;
        document.getElementById("txtdes").value = cous.description;
        document.getElementById("btnupdate").removeAttribute("hidden");
        document.getElementById("btnsubmit").setAttribute("hidden","hidden");
    };

    const clear = () => {
        document.getElementById("btnsubmit").removeAttribute("hidden");
        document.getElementById("btnupdate").setAttribute("hidden","hidden");
    };

    const DeleteData = async (id) => {
        if(confirm("Really want to delete course")) {
            await fetch("/Developer/Course/DeleteCourse/"+id,{
                method:'post',
                headers:{ 'content-type':'application/json' }
            });
            alert("Course Deleted Successfully");
            Display();
        }
    };

    Display();
    clear();
</script>

