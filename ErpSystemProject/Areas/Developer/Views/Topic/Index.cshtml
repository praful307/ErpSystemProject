
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/DeveloperLayout.cshtml";
}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<div class="container-fluid py-2" style="background-color:white;">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-10">
            <div class="card shadow-lg border-0 rounded-4">
                <div class="card-header text-center  bg-gradient text-white rounded-top-4" style="background-color:navy">
                    <h3 class="fw-semibold mb-0"><i class="bi bi-journal-text me-2"></i>Add Topic</h3>
                </div>

                <div class="card-body px-5 py-4">
                    <!-- Topic Form -->
                    @Html.Hidden("txttopicid")

                    <div class="row g-4 align-items-center">
                        <div class="col-md-6">
                            <label class="form-label fw-bold text-primary mb-1">Topic Name</label>
                            @Html.TextBox("txttopic", null, new { @class = "form-control shadow-sm", placeholder = "Enter Topic Name" })
                        </div>

                        <div class="col-md-6">
                            <label class="form-label fw-bold text-primary mb-1">Description</label>
                            @Html.TextArea("txtdes", null, new { @class = "form-control shadow-sm", placeholder = "Enter Description", rows = 2 })
                        </div>
                    </div>

                    <div class="text-center mt-4">
                        <button type="button" class="btn btn-success px-4 py-2 rounded-pill shadow-sm fw-semibold me-2" id="btnsubmit" onclick="addtopic()">
                            <i class="bi bi-check2-circle me-2"></i>Submit
                        </button>
                        <button type="button" class="btn btn-info px-4 py-2 rounded-pill shadow-sm fw-semibold" id="btnupdate" onclick="updatetopic()">
                            <i class="bi bi-arrow-repeat me-2"></i>Update
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Table Section -->
    <div class="row justify-content-center mt-5">
        <div class="col-md-10">
            <div class="card shadow-sm border-0 rounded-4">
                <div class="card-header  bg-gradient text-white text-center rounded-top-4" style="background-color:navy">
                    <h5 class="mb-0 fw-semibold"><i class="bi bi-list-ul me-2"></i>Topic List</h5>
                </div>
                <div class="card-body p-0 scroll-table">
                    <table class="table table-bordered table-striped mb-0 text-center align-middle" style="min-width:800px;">
                        <thead class="table-primary">
                            <tr>
                                <th>Sr.No</th>
                                <th>Topic Name</th>
                                <th>Description</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="tbldata"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scroll Table & Page Styling -->
<style>
    body {
        background-color: #eef3f9;
        font-family: 'Segoe UI', sans-serif;
    }

    .scroll-table {
        max-height: 400px;
        overflow-y: auto;
        overflow-x: auto;
        display: block;
    }

        .scroll-table table thead th {
            position: sticky;
            top: 0;
            z-index: 2;
        }

    .btn:hover {
        transform: scale(1.03);
        transition: all 0.2s ease-in-out;
    }

    .table th {
        color: darkblue;
    }
</style>



            <script>
//==============================Add Topic=====================================================
    const addtopic=async()=>{
  
       var st={
           "TopicName":  document.getElementById("txttopic").value,
           "TopicDescription":document.getElementById("txtdes").value
        
       }
       const response= await fetch("/Developer/Topic/AddTopic",{
           method:'post',
           body:JSON.stringify(st),
           headers:{
               "content-type":'application/json'
           }
       })
       const topic = await response.json();
  
       displayData()
       alert("Topic Added Successfully");
       window.location.reload();
    }
    //=======================DisplayTopic================================
    const displayData = async () => {
        const response = await fetch("/Developer/Topic/GetTopic");
        const dis = await response.json();
 
        let data = "";
        dis.forEach((d, k) => {
            data += `<tr>
                        <td>${k + 1}</td>
                        <td>${d.topicName}</td>
                        <td>${d.topicDescription}</td>
                        <td>
                            <input type='button' value='View' class='btn btn-info' onclick='EditData(${d.topicId})'/>
                            &nbsp;
                            <input type='button' value='Delete' class='btn btn-danger' onclick='DeleteData(${d.topicId})'/>
                        </td>
                     </tr>`;
        });
        document.getElementById("tbldata").innerHTML = data;
    }


    displayData();

    //=========================EditTopic==============================
    const EditData=async(id)=>{

        const response = await fetch("/Developer/Topic/GetTopicByid/"+id);
        const cous= await response.json();
        document.getElementById("txttopicid").value=cous.topicId;
        document.getElementById("txttopic").value=cous.topicName;
        document.getElementById("txtdes").value=cous.topicDescription;
                document.getElementById("btnupdate").removeAttribute("hidden");
          document.getElementById("btnsubmit").setAttribute("hidden","hidden");

    }


    //=======================================UpdateTopic===========================
    const  updatetopic=async()=>{
        debugger;
          var st={
           "TopicId": document.getElementById("txttopicid").value,
           "TopicName":  document.getElementById("txttopic").value,
           "TopicDescription":document.getElementById("txtdes").value

       }
       const response= await fetch("/Developer/Topic/updateTopic",{
           method:'post',
           body:JSON.stringify(st),
           headers:{
               "content-type":'application/json'
           }
       })
       const topic = await response.json();

       displayData()
       alert("Topic Update Successfully");
       window.location.reload();
    }

    //==================================Delete Topic=====================================================

            const DeleteData = async(id)=> {
            if(confirm("Really want to delete topic")) {
                    const response = await fetch("/Developer/Topic/DeleteTopic/"+id,{
                    method:'post',
                    headers:{
                        'content-type':'application/json'
                    }
                });
                const deleteco= await response.json();
                         // displayData();
                 alert("Topic Delete Successfully");
                
                window.location.reload();
            }
        }
    //=======================================Clear Topic====================================================
    const cleardata=()=>{

        document.getElementById("txttopicid").value=""
        document.getElementById("txttopic").value=""
        document.getElementById("txtdes").value="";
           document.getElementById("btnsubmit").removeAttribute("hidden");
          document.getElementById("btnupdate").setAttribute("hidden","hidden");

    }
        cleardata();
            </script>